(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(e){"use strict";var t="styler",i="-"+t,s="jq-",l={wrapper:"form",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:false,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:true,checkboxIndeterminate:false,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};function o(t,i){this.element=t;this.options=e.extend({},l,i);this.init()}o.prototype={init:function(){var l=e(this.element),o=this.options;var n=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false,d=navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false;function r(){var e="",s="",o="",a="";if(l.attr("id")!==undefined&&l.attr("id")!==""){e=' id="'+l.attr("id")+i+'"'}if(l.attr("title")!==undefined&&l.attr("title")!==""){s=' title="'+l.attr("title")+'"'}if(l.attr("class")!==undefined&&l.attr("class")!==""){o=" "+l.attr("class")}var n=l.data();for(var d in n){if(n[d]!==""&&d!=="_"+t){a+=" data-"+d+'="'+n[d]+'"'}}e+=a;this.id=e;this.title=s;this.classes=o}if(l.is(":checkbox")){var c=function(){var i=new r,a=e("<div"+i.id+' class="'+s+"checkbox"+i.classes+'"'+i.title+'><div class="'+s+'checkbox__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});if(l.is(":disabled")){a.addClass("disabled")}a.click(function(e){e.preventDefault();if(!a.is(".disabled")){if(l.is(":checked")||l.is(":indeterminate")){l.prop("checked",o.checkboxIndeterminate===true&&l.is(":indeterminate"));l.prop("indeterminate",false)}else{if(o.checkboxIndeterminate===true){l.prop("checked",false);l.prop("indeterminate",true)}else{l.prop("checked",true);l.prop("indeterminate",false)}}l.focus().change()}});l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});l.on("change."+t,function(){if(l.is(":checked")||l.is(":indeterminate")){if(l.is(":indeterminate")){a.removeClass("checked");a.addClass("indeterminate")}else{a.removeClass("indeterminate");a.addClass("checked")}}else{a.removeClass("indeterminate");a.removeClass("checked")}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();a.click()}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});l.change()};c();l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t);l.off("."+t).parent().before(l).remove();c()})}else if(l.is(":radio")){var f=function(){var i=new r,a=e("<div"+i.id+' class="'+s+"radio"+i.classes+'"'+i.title+'><div class="'+s+'radio__div"></div></div>');l.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});if(l.is(":disabled")){a.addClass("disabled")}a.click(function(t){t.preventDefault();var i=a.closest(o.wrapper).find('input[name="'+l.attr("name")+'"]:radio');if(i.length<=0){i=a.closest("#"+l.attr("name")).find('input[name="'+l.attr("name")+'"]:radio')}if(i.length<=0){i=e("body").find('input[name="'+l.attr("name")+'"]:radio')}i.prop("checked",false).parent().removeClass("checked");if(!a.is(".disabled")){l.prop("checked",true).focus().change()}});l.on("change."+t,function(t){if(!l.is(":disabled")){if(e(this).is(":checked")){l.parent().addClass("checked")}else{l.parent().removeClass("checked")}}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});l.closest("label").add('label[for="'+l.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});l.change()};f();l.on("refresh",function(){l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t);l.off("."+t).parent().before(l).remove();f()})}else if(l.is(":file")){l.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0});var u=function(){var i=new r,a=l.data("placeholder"),n=l.data("browse");if(a===undefined){a=o.filePlaceholder}if(n===undefined||n===""){n=o.fileBrowse}var d=e("<div"+i.id+' class="'+s+"file"+i.classes+'"'+i.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),c=e('<div class="'+s+'file__name">'+a+"</div>").appendTo(d);e('<div class="'+s+'file__browse">'+n+"</div>").appendTo(d);l.after(d).appendTo(d);if(l.is(":disabled")){d.addClass("disabled")}l.on("change."+t,function(){var e=l.val();if(l.is("[multiple]")){var t=l[0].files.length;e="";if(t>0){var i=l.data("number");if(i===undefined){i=o.fileNumber}i=i.replace("%s",t);e=i}}c.text(e.replace(/.+[\\\/]/,""));if(e===""){c.text(a);d.removeClass("changed")}else{d.addClass("changed")}}).on("focus."+t,function(){d.addClass("focused")}).on("blur."+t,function(){d.removeClass("focused")}).on("click."+t,function(){d.removeClass("focused")});l.change()};u();l.on("refresh",function(){l.off("."+t).parent().before(l).remove();u()})}else if(l.is('input[type="number"]')){var h=function(){var i=e('<div class="'+s+'number"><div class="'+s+'number__spin minus"></div><div class="'+s+'number__spin plus"></div></div>'),o,a,n,d=null,r=null;l.after(i).prependTo(i).wrap('<div class="'+s+'number__field"></div>');if(l.is(":disabled")){i.addClass("disabled")}if(l.attr("min")!==undefined){o=l.attr("min")}if(l.attr("max")!==undefined){a=l.attr("max")}if(l.attr("step")!==undefined&&e.isNumeric(l.attr("step"))){n=Number(l.attr("step"))}else{n=Number(1)}var c=function(t){var i=l.val(),s;if(!e.isNumeric(i)){i=0;l.val("0")}if(t.is(".minus")){s=parseInt(i,10)-n;if(n>0){s=Math.ceil(s/n)*n}}else if(t.is(".plus")){s=parseInt(i,10)+n;if(n>0){s=Math.floor(s/n)*n}}if(e.isNumeric(o)&&e.isNumeric(a)){if(s>=o&&s<=a){l.val(s)}}else if(e.isNumeric(o)&&!e.isNumeric(a)){if(s>=o){l.val(s)}}else if(!e.isNumeric(o)&&e.isNumeric(a)){if(s<=a){l.val(s)}}else{l.val(s)}};if(!i.is(".disabled")){i.on("mousedown","div."+s+"number__spin",function(){var t=e(this);c(t);d=setTimeout(function(){r=setInterval(function(){c(t)},40)},350)}).on("mouseup mouseout","div."+s+"number__spin",function(){clearTimeout(d);clearInterval(r)});l.on("focus."+t,function(){i.addClass("focused")}).on("blur."+t,function(){i.removeClass("focused")})}l.change()};h();l.on("refresh",function(){l.off("."+t).closest("."+s+"number").before(l).remove();h()})}else if(l.is("select")){var p=function(){function c(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var i=null;if(t.type==="mousewheel"){i=t.originalEvent.wheelDelta*-1}else if(t.type==="DOMMouseScroll"){i=40*t.originalEvent.detail}if(i){t.stopPropagation();t.preventDefault();e(this).scrollTop(i+e(this).scrollTop())}})}var f=e("option",l),u="";function h(){for(var e=0;e<f.length;e++){var t=f.eq(e),s="",l="",o="",a="",n="",d="",r="",c="",h="",p="disabled",v="selected sel disabled";if(t.prop("selected")){l="selected sel"}if(t.is(":disabled")){l=p}if(t.is(":selected:disabled")){l=v}if(t.attr("id")!==undefined&&t.attr("id")!==""){a=' id="'+t.attr("id")+i+'"'}if(t.attr("title")!==undefined&&f.attr("title")!==""){n=' title="'+t.attr("title")+'"'}if(t.attr("class")!==undefined){r=" "+t.attr("class");h=' data-jqfs-class="'+t.attr("class")+'"'}var m=t.data();for(var g in m){if(m[g]!==""){d+=" data-"+g+'="'+m[g]+'"'}}if(l+r!==""){o=' class="'+l+r+'"'}s="<li"+h+d+o+n+a+">"+t.html()+"</li>";if(t.parent().is("optgroup")){if(t.parent().attr("class")!==undefined){c=" "+t.parent().attr("class")}s="<li"+h+d+' class="'+l+r+" option"+c+'"'+n+a+">"+t.html()+"</li>";if(t.is(":first-child")){s='<li class="optgroup'+c+'">'+t.parent().attr("label")+"</li>"+s}}u+=s}}function p(){var i=new r,d="",p=l.data("placeholder"),v=l.data("search"),m=l.data("search-limit"),g=l.data("search-not-found"),b=l.data("search-placeholder"),C=l.data("z-index"),w=l.data("smart-positioning");if(p===undefined){p=o.selectPlaceholder}if(v===undefined||v===""){v=o.selectSearch}if(m===undefined||m===""){m=o.selectSearchLimit}if(g===undefined||g===""){g=o.selectSearchNotFound}if(b===undefined){b=o.selectSearchPlaceholder}if(C===undefined||C===""){C=o.singleSelectzIndex}if(w===undefined||w===""){w=o.selectSmartPositioning}var x=e("<div"+i.id+' class="'+s+"selectbox jqselect"+i.classes+'" style="display: inline-block; position: relative; z-index:'+C+'">'+'<div class="'+s+'selectbox__select"'+i.title+' style="position: relative">'+'<div class="'+s+'selectbox__select-text"></div>'+'<div class="'+s+'selectbox__trigger"><div class="'+s+'selectbox__trigger-arrow"></div></div>'+"</div>"+"</div>");l.css({margin:0,padding:0}).after(x).prependTo(x);var y=e("div."+s+"selectbox__select",x),_=e("div."+s+"selectbox__select-text",x),k=f.filter(":selected");h();if(v){d='<div class="'+s+'selectbox__search"><input type="search" autocomplete="off" placeholder="'+b+'"></div>'+'<div class="'+s+'selectbox__not-found">'+g+"</div>"}var T=e('<div class="'+s+'selectbox__dropdown" style="position: absolute">'+d+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+u+"</ul>"+"</div>");x.append(T);var S=e("ul",T),q=e("li",T),j=e("input",T),I=e("div."+s+"selectbox__not-found",T).hide();if(q.length<m){j.parent().hide()}if(k.text()===""){_.text(p).addClass("placeholder")}else{_.text(k.text())}var N=0,A=0;q.css({display:"inline-block"});q.each(function(){var t=e(this);if(t.innerWidth()>N){N=t.innerWidth();A=t.width()}});q.css({display:""});if(_.is(".placeholder")&&_.width()>N){_.width(_.width())}else{var P=x.clone().appendTo("body").width("auto");var D=P.outerWidth();P.remove();if(D===x.outerWidth()){_.width(A)}}if(N>x.width()){T.width(N)}if(f.first().text()===""&&l.data("placeholder")!==""){q.first().hide()}l.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var H=x.outerHeight(true),z=j.parent().outerHeight(true),M=S.css("max-height"),K=q.filter(".selected"),O=T.css("top");if(K.length<1){q.first().addClass("selected sel")}if(q.data("li-height")===undefined){q.data("li-height",q.outerHeight())}if(T.css("left")==="auto"){T.css({left:0})}if(T.css("top")==="auto"){T.css({top:H})}T.hide();if(K.length){if(f.first().text()!==k.text()){x.addClass("changed")}x.data("jqfs-class",K.data("jqfs-class"));x.addClass(K.data("jqfs-class"))}if(l.is(":disabled")){x.addClass("disabled");return false}y.click(function(){if(e("div."+s+"selectbox").filter(".opened").length){o.onSelectClosed.call(e("div."+s+"selectbox").filter(".opened"))}l.focus();if(n){return}var t=e(window),i=q.data("li-height"),a=x.offset().top,d=t.height()-H-(a-t.scrollTop()),r=l.data("visible-options"),u=i*5,h=i*r;if(r===undefined||r===""){r=o.selectVisibleOptions}if(r>0&&r<6){u=h}if(r===0){h="auto"}var p=function(){var e=function(){S.css("max-height",Math.floor((d-20-z)/i)*i)};T.height("auto").css({bottom:"auto",top:O});e();S.css("max-height",h);if(M!=="none"){S.css("max-height",M)}if(d<T.outerHeight()+20){e()}};var v=function(){var e=function(){S.css("max-height",Math.floor((a-t.scrollTop()-20-z)/i)*i)};T.height("auto").css({top:"auto",bottom:O});e();S.css("max-height",h);if(M!=="none"){S.css("max-height",M)}if(a-t.scrollTop()-20<T.outerHeight()+20){e()}};if(w===true||w===1){if(d>u+z+20){p();x.removeClass("dropup").addClass("dropdown")}else{v();x.removeClass("dropdown").addClass("dropup")}}else if(w===false||w===0){if(d>u+z+20){p();x.removeClass("dropup").addClass("dropdown")}}if(x.offset().left+T.outerWidth()>t.width()){T.css({left:"auto",right:0})}e("div.jqselect").css({zIndex:C-1}).removeClass("opened");x.css({zIndex:C});if(T.is(":hidden")){e("div."+s+"selectbox__dropdown:visible").hide();T.show();x.addClass("opened focused");o.onSelectOpened.call(x)}else{T.hide();x.removeClass("opened dropup dropdown");if(e("div."+s+"selectbox").filter(".opened").length){o.onSelectClosed.call(x)}}if(j.length){j.val("").keyup();I.hide();j.keyup(function(){var t=e(this).val();q.each(function(){if(!e(this).html().match(new RegExp(".*?"+t+".*?","i"))){e(this).hide()}else{e(this).show()}});if(f.first().text()===""&&l.data("placeholder")!==""){q.first().hide()}if(q.filter(":visible").length<1){I.show()}else{I.hide()}})}if(q.filter(".selected").length){if(l.val()===""){S.scrollTop(0)}else{if(S.innerHeight()/i%2!==0){i=i/2}S.scrollTop(S.scrollTop()+q.filter(".selected").position().top-S.innerHeight()/2+i)}}c(S)});q.hover(function(){e(this).siblings().removeClass("selected")});var W=q.filter(".selected").text();q.filter(":not(.disabled):not(.optgroup)").click(function(){var t=e(this),i=t.text();l.focus();if(!t.is(".selected")){var s=t.index();s-=t.prevAll(".optgroup").length;t.addClass("selected sel").siblings().removeClass("selected sel");f.prop("selected",false).eq(s).prop("selected",true);W=i;_.text(i);if(x.data("jqfs-class")){x.removeClass(x.data("jqfs-class"))}x.data("jqfs-class",t.data("jqfs-class"));x.addClass(t.data("jqfs-class"));l.change()}T.hide();x.removeClass("opened dropup dropdown");o.onSelectClosed.call(x)});T.mouseout(function(){e("li.sel",T).addClass("selected")});l.on("change."+t,function(){_.text(f.filter(":selected").text()).removeClass("placeholder");q.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel");if(f.first().text()!==q.filter(".selected").text()){x.addClass("changed")}else{x.removeClass("changed")}}).on("focus."+t,function(){x.addClass("focused");e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div."+s+"selectbox__dropdown").hide()}).on("blur."+t,function(){x.removeClass("focused")}).on("keydown."+t+" keyup."+t,function(e){var t=q.data("li-height");if(l.val()===""){_.text(p).addClass("placeholder")}else{_.text(f.filter(":selected").text())}q.removeClass("selected sel").not(".optgroup").eq(l[0].selectedIndex).addClass("selected sel");if(e.which===38||e.which===37||e.which===33||e.which===36){if(l.val()===""){S.scrollTop(0)}else{S.scrollTop(S.scrollTop()+q.filter(".selected").position().top)}}if(e.which===40||e.which===39||e.which===34||e.which===35){S.scrollTop(S.scrollTop()+q.filter(".selected").position().top-S.innerHeight()+t)}if(e.which===13){e.preventDefault();T.hide();x.removeClass("opened dropup dropdown");o.onSelectClosed.call(x)}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();y.click()}});if(!a.registered){e(document).on("click",a);a.registered=true}}function v(){var i=new r,o=e("<div"+i.id+' class="'+s+"select-multiple jqselect"+i.classes+'"'+i.title+' style="display: inline-block; position: relative"></div>');l.css({margin:0,padding:0}).after(o);h();o.append("<ul>"+u+"</ul>");var a=e("ul",o).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),n=e("li",o).attr("unselectable","on"),d=l.attr("size"),p=a.outerHeight(),v=n.outerHeight();if(d!==undefined&&d>0){a.css({height:v*d})}else{a.css({height:v*4})}if(p>o.height()){a.css("overflowY","scroll");c(a);if(n.filter(".selected").length){a.scrollTop(a.scrollTop()+n.filter(".selected").position().top)}}l.prependTo(o).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});if(l.is(":disabled")){o.addClass("disabled");f.each(function(){if(e(this).is(":selected")){n.eq(e(this).index()).addClass("selected")}})}else{n.filter(":not(.disabled):not(.optgroup)").click(function(t){l.focus();var i=e(this);if(!t.ctrlKey&&!t.metaKey){i.addClass("selected")}if(!t.shiftKey){i.addClass("first")}if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey){i.siblings().removeClass("selected first")}if(t.ctrlKey||t.metaKey){if(i.is(".selected")){i.removeClass("selected first")}else{i.addClass("selected first")}i.siblings().removeClass("first")}if(t.shiftKey){var s=false,o=false;i.siblings().removeClass("selected").siblings(".first").addClass("selected");i.prevAll().each(function(){if(e(this).is(".first")){s=true}});i.nextAll().each(function(){if(e(this).is(".first")){o=true}});if(s){i.prevAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(o){i.nextAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(n.filter(".selected").length===1){i.addClass("first")}}f.prop("selected",false);n.filter(".selected").each(function(){var t=e(this),i=t.index();if(t.is(".option")){i-=t.prevAll(".optgroup").length}f.eq(i).prop("selected",true)});l.change()});f.each(function(t){e(this).data("optionIndex",t)});l.on("change."+t,function(){n.removeClass("selected");var t=[];f.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))});n.not(".optgroup").filter(function(i){return e.inArray(i,t)>-1}).addClass("selected")}).on("focus."+t,function(){o.addClass("focused")}).on("blur."+t,function(){o.removeClass("focused")});if(p>o.height()){l.on("keydown."+t,function(e){if(e.which===38||e.which===37||e.which===33){a.scrollTop(a.scrollTop()+n.filter(".selected").position().top-v)}if(e.which===40||e.which===39||e.which===34){a.scrollTop(a.scrollTop()+n.filter(".selected:last").position().top-a.innerHeight()+v*2)}})}}}if(l.is("[multiple]")){if(d||n){return}v()}else{p()}};p();l.on("refresh",function(){l.off("."+t).parent().before(l).remove();p()})}else if(l.is('input[type="hidden"]')){return false}else if(l.is("input")){l.addClass(t)}else if(l.is(":reset")){l.on("click",function(){setTimeout(function(){l.closest(o.wrapper).find("input, select").trigger("refresh")},1)})}},destroy:function(i){var l=e(this.element);if(!i){l.removeData("_"+t)}if(l.is(":checkbox")||l.is(":radio")){l.off("."+t+" refresh").removeAttr("style").parent().before(l).remove();l.closest("label").add('label[for="'+l.attr("id")+'"]').off("."+t)}else if(l.is('input[type="number"]')){l.off("."+t+" refresh").closest("."+s+"number").before(l).remove()}else if(l.is(":file")||l.is("select")){l.off("."+t+" refresh").removeAttr("style").parent().before(l).remove()}},reinitialize:function(t){this.destroy(true);this.options=e.extend({},l,t);this.init()}};e.fn[t]=function(i){var s=arguments;if(i===undefined||typeof i==="object"){this.each(function(){if(!e.data(this,"_"+t)){e.data(this,"_"+t,new o(this,i))}}).promise().done(function(){var i=e(this[0]).data("_"+t);if(i){i.options.onFormStyled.call()}});return this}else if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var l;this.each(function(){var a=e.data(this,"_"+t);if(a instanceof o&&typeof a[i]==="function"){l=a[i].apply(a,Array.prototype.slice.call(s,1))}});return l!==undefined?l:this}};function a(i){if(!e(i.target).parents().hasClass(""+s+"selectbox")&&i.target.nodeName!=="OPTION"){if(e("div."+s+"selectbox.opened").length){var l=e("div."+s+"selectbox.opened"),o=e("div."+s+"selectbox__search input",l),a=e("div."+s+"selectbox__dropdown",l),n=l.find("select").data("_"+t).options;n.onSelectClosed.call(l);if(o.length){o.val("").keyup()}a.hide().find("li.sel").addClass("selected");l.removeClass("focused opened dropup dropdown")}}}a.registered=false});