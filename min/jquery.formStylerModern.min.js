(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(e){"use strict";var t="styler",i="-"+t,s={wrapper:"form",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:false,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:true,checkboxIndeterminate:false,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};function l(t,i){this.element=t;this.options=e.extend({},s,i);this.init()}l.prototype={init:function(){var s=e(this.element),l=this.options;var o=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false,n=navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?true:false;function d(){if(s.attr("id")!==undefined&&s.attr("id")!==""){this.id=s.attr("id")+i}this.title=s.attr("title");this.classes=s.attr("class");this.data=s.data()}if(s.is(":checkbox")){var r=function(){var i=new d,a=e('<div class="jq-checkbox"><div class="jq-checkbox__div"></div></div>').attr({id:i.id,title:i.title}).addClass(i.classes).data(i.data);s.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative",overflow:"hidden"});if(s.is(":disabled")){a.addClass("disabled")}a.click(function(e){e.preventDefault();if(!a.is(".disabled")){if(s.is(":checked")||s.is(":indeterminate")){s.prop("checked",l.checkboxIndeterminate===true&&s.is(":indeterminate"));s.prop("indeterminate",false)}else{if(l.checkboxIndeterminate===true){s.prop("checked",false);s.prop("indeterminate",true)}else{s.prop("checked",true);s.prop("indeterminate",false)}}s.focus().change()}});s.closest("label").add('label[for="'+s.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});s.on("change."+t,function(){if(s.is(":checked")||s.is(":indeterminate")){if(s.is(":indeterminate")){a.removeClass("checked");a.addClass("indeterminate")}else{a.removeClass("indeterminate");a.addClass("checked")}}else{a.removeClass("indeterminate");a.removeClass("checked")}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();a.click()}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});s.change()};r();s.on("refresh",function(){s.closest("label").add('label[for="'+s.attr("id")+'"]').off("."+t);s.off("."+t).parent().before(s).remove();r()})}else if(s.is(":radio")){var c=function(){var i=new d,a=e('<div class="jq-radio"><div class="jq-radio__div"></div></div>').attr({id:i.id,title:i.title}).addClass(i.classes).data(i.data);s.css({position:"absolute",zIndex:"-1",opacity:0,margin:0,padding:0}).after(a).prependTo(a);a.attr("unselectable","on").css({"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","-o-user-select":"none","user-select":"none",display:"inline-block",position:"relative"});if(s.is(":disabled")){a.addClass("disabled")}a.click(function(t){t.preventDefault();if(!a.is(".disabled")){var i=a.closest(l.wrapper).find('input[name="'+s.attr("name")+'"]:radio');if(i.length<=0){i=a.closest("#"+s.attr("name")).find('input[name="'+s.attr("name")+'"]:radio')}if(i.length<=0){i=e("body").find('input[name="'+s.attr("name")+'"]:radio')}i.prop("checked",false).parent().removeClass("checked");s.prop("checked",true).focus().change()}});s.on("change."+t,function(t){if(!s.is(":disabled")){if(e(this).is(":checked")){s.parent().addClass("checked")}else{s.parent().removeClass("checked")}}}).on("focus."+t,function(){if(!a.is(".disabled")){a.addClass("focused")}}).on("blur."+t,function(){a.removeClass("focused")});s.closest("label").add('label[for="'+s.attr("id")+'"]').on("click."+t,function(t){if(!e(t.target).is("a")&&!e(t.target).closest(a).length){a.triggerHandler("click");t.preventDefault()}});s.change()};c();s.on("refresh",function(){s.closest("label").add('label[for="'+s.attr("id")+'"]').off("."+t);s.off("."+t).parent().before(s).remove();c()})}else if(s.is(":file")){s.css({position:"absolute",top:0,right:0,opacity:0,margin:0,padding:0,fontSize:"100px"});var f=function(){var i=new d,a=s.data("placeholder"),o=s.data("browse");if(a===undefined){a=l.filePlaceholder}if(o===undefined||o===""){o=l.fileBrowse}var n=e('<div class="jq-file">'+'<div class="jq-file__name">'+a+"</div>"+'<div class="jq-file__browse">'+o+"</div>"+"</div>").css({display:"inline-block",position:"relative",overflow:"hidden"}).attr({id:i.id,title:i.title}).addClass(i.classes).data(i.data);s.after(n).appendTo(n);if(s.is(":disabled")){n.addClass("disabled")}s.on("change."+t,function(){var t=s.val(),i=e("div.jq-file__name",n);if(s.is("[multiple]")){var o=s[0].files.length;t="";if(o>0){var d=s.data("number");if(d===undefined){d=l.fileNumber}d=d.replace("%s",o);t=d}}i.text(t.replace(/.+[\\\/]/,""));if(t===""){i.text(a);n.removeClass("changed")}else{n.addClass("changed")}}).on("focus."+t,function(){n.addClass("focused")}).on("blur."+t,function(){n.removeClass("focused")}).on("click."+t,function(){n.removeClass("focused")});s.change()};f();s.on("refresh",function(){s.off("."+t).parent().before(s).remove();f()})}else if(s.is('input[type="number"]')){var u=function(){var i,l,a,o=null,n=null;var r=new d,c=e('<div class="jq-number">'+'<div class="jq-number__spin minus"></div>'+'<div class="jq-number__spin plus"></div>'+"</div>").attr({id:r.id,title:r.title}).addClass(r.classes).data(r.data);s.after(c).prependTo(c).wrap('<div class="jq-number__field"></div>');if(s.is(":disabled")){c.addClass("disabled")}if(s.attr("min")!==undefined){i=s.attr("min")}if(s.attr("max")!==undefined){l=s.attr("max")}if(s.attr("step")!==undefined&&e.isNumeric(s.attr("step"))){a=Number(s.attr("step"))}else{a=Number(1)}var f=function(t){var o=s.val(),n;if(!e.isNumeric(o)){o=0;s.val("0").change()}if(t.is(".minus")){n=Number(o)-a}else if(t.is(".plus")){n=Number(o)+a}var d=(a.toString().split(".")[1]||[]).length.prototype,r="1";if(d>0){while(r.length<=d){r=r+"0"}n=Math.round(n*r)/r}if(e.isNumeric(i)&&e.isNumeric(l)){if(n>=i&&n<=l){s.val(n).change()}}else if(e.isNumeric(i)&&!e.isNumeric(l)){if(n>=i){s.val(n).change()}}else if(!e.isNumeric(i)&&e.isNumeric(l)){if(n<=l){s.val(n).change()}}else{s.val(n).change()}};if(!c.is(".disabled")){c.on("mousedown","div.jq-number__spin",function(){var t=e(this);f(t);o=setTimeout(function(){n=setInterval(function(){f(t)},40)},350)}).on("mouseup mouseout","div.jq-number__spin",function(){clearTimeout(o);clearInterval(n)});s.on("focus."+t,function(){c.addClass("focused")}).on("blur."+t,function(){c.removeClass("focused")})}s.change()};u();s.on("refresh",function(){s.off("."+t).closest(".jq-number").before(s).remove();u()})}else if(s.is("select")){var h=function(){function r(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var i=null;if(t.type==="mousewheel"){i=t.originalEvent.wheelDelta*-1}else if(t.type==="DOMMouseScroll"){i=40*t.originalEvent.detail}if(i){t.stopPropagation();t.preventDefault();e(this).scrollTop(i+e(this).scrollTop())}})}var c=e("option",s);function f(){var e="";for(var t=0;t<c.length;t++){var s=c.eq(t),l="",a="",o="",n="",d="",r="",f="",u="",h="",p="disabled",v="selected sel disabled";if(s.is(":selected")){a="selected sel"}if(s.is(":disabled")){a=p}if(s.is(":selected:disabled")){a=v}if(s.attr("id")!==undefined&&s.attr("id")!==""){n=' id="'+s.attr("id")+i+'"'}if(s.attr("title")!==undefined&&c.attr("title")!==""){d=' title="'+s.attr("title")+'"'}if(s.attr("class")!==undefined){f=" "+s.attr("class");h=' data-jqfs-class="'+s.attr("class")+'"'}var m=s.data();for(var g in m){if(m[g]!==""){r+=" data-"+g+'="'+m[g]+'"'}}if(a+f!==""){o=' class="'+a+f+'"'}l="<li"+h+r+o+d+n+">"+s.html()+"</li>";if(s.parent().is("optgroup")){if(s.parent().attr("class")!==undefined){u=" "+s.parent().attr("class")}l="<li"+h+r+' class="'+a+f+" option"+u+'"'+d+n+">"+s.html()+"</li>";if(s.is(":first-child")){l='<li class="optgroup'+u+'">'+s.parent().attr("label")+"</li>"+l}}e+=l}return e}function u(){var i=new d,u="",h=s.data("placeholder"),p=s.data("search"),v=s.data("search-limit"),m=s.data("search-not-found"),g=s.data("search-placeholder"),b=s.data("z-index"),C=s.data("smart-positioning");if(h===undefined){h=l.selectPlaceholder}if(p===undefined||p===""){p=l.selectSearch}if(v===undefined||v===""){v=l.selectSearchLimit}if(m===undefined||m===""){m=l.selectSearchNotFound}if(g===undefined){g=l.selectSearchPlaceholder}if(b===undefined||b===""){b=l.singleSelectzIndex}if(C===undefined||C===""){C=l.selectSmartPositioning}var w=e('<div class="jq-selectbox jqselect">'+'<div class="jq-selectbox__select" style="position: relative">'+'<div class="jq-selectbox__select-text"></div>'+'<div class="jq-selectbox__trigger">'+'<div class="jq-selectbox__trigger-arrow"></div></div>'+"</div>"+"</div>").css({display:"inline-block",position:"relative",zIndex:b}).attr({id:i.id,title:i.title}).addClass(i.classes).data(i.data);s.css({margin:0,padding:0}).after(w).prependTo(w);var x=e("div.jq-selectbox__select",w),y=e("div.jq-selectbox__select-text",w),q=c.filter(":selected");var j=f();if(p){u='<div class="jq-selectbox__search"><input type="search" autocomplete="off" placeholder="'+g+'"></div>'+'<div class="jq-selectbox__not-found">'+m+"</div>"}var _=e('<div class="jq-selectbox__dropdown" style="position: absolute">'+u+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+j+"</ul>"+"</div>");w.append(_);var k=e("ul",_),T=e("li",_),S=e("input",_),N=e("div.jq-selectbox__not-found",_).hide();if(T.length<v){S.parent().hide()}if(q.text()===""){y.text(h).addClass("placeholder")}else{y.text(q.text())}var P=0,I=0;T.css({display:"inline-block"});T.each(function(){var t=e(this);if(t.innerWidth()>P){P=t.innerWidth();I=t.width()}});T.css({display:""});if(y.is(".placeholder")&&y.width()>P){y.width(y.width())}else{var A=w.clone().appendTo("body").width("auto");var z=A.outerWidth();A.remove();if(z===w.outerWidth()){y.width(I)}}if(P>w.width()){_.width(P)}if(c.first().text()===""&&s.data("placeholder")!==""){T.first().hide()}s.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var D=w.outerHeight(true),H=S.parent().outerHeight(true),K=k.css("max-height"),M=T.filter(".selected"),O=_.css("top");if(T.data("li-height")===undefined){T.data("li-height",T.outerHeight())}if(_.css("left")==="auto"){_.css({left:0})}if(_.css("top")==="auto"){_.css({top:D})}_.hide();if(M.length){if(c.first().text()!==q.text()){w.addClass("changed")}w.data("jqfs-class",M.data("jqfs-class"));w.addClass(M.data("jqfs-class"))}if(s.is(":disabled")){w.addClass("disabled");return false}x.click(function(){if(e("div.jq-selectbox").filter(".opened").length){l.onSelectClosed.call(e("div.jq-selectbox").filter(".opened"))}s.focus();if(n||o){return}var t=e(window),i=T.data("li-height"),a=w.offset().top,d=t.height()-D-(a-t.scrollTop()),f=s.data("visible-options"),u=i*5,h=i*f;if(f===undefined||f===""){f=l.selectVisibleOptions}if(f>0&&f<6){u=h}if(f===0){h="auto"}var p=function(){var e=function(){k.css("max-height",Math.floor((d-20-H)/i)*i)};_.height("auto").css({bottom:"auto",top:O});e();k.css("max-height",h);if(K!=="none"){k.css("max-height",K)}if(d<_.outerHeight()+20){e()}};var v=function(){var e=function(){k.css("max-height",Math.floor((a-t.scrollTop()-20-H)/i)*i)};_.height("auto").css({top:"auto",bottom:O});e();k.css("max-height",h);if(K!=="none"){k.css("max-height",K)}if(a-t.scrollTop()-20<_.outerHeight()+20){e()}};if(C===true||C===1){if(d>u+H+20){p();w.removeClass("dropup").addClass("dropdown")}else{v();w.removeClass("dropdown").addClass("dropup")}}else if(C===false||C===0){if(d>u+H+20){p();w.removeClass("dropup").addClass("dropdown")}}if(w.offset().left+_.outerWidth()>t.width()){_.css({left:"auto",right:0})}e("div.jqselect").css({zIndex:b-1}).removeClass("opened");w.css({zIndex:b});if(_.is(":hidden")){e("div.jq-selectbox__dropdown:visible").hide();_.show();w.addClass("opened focused");l.onSelectOpened.call(w)}else{_.hide();w.removeClass("opened dropup dropdown");if(e("div.jq-selectbox").filter(".opened").length){l.onSelectClosed.call(w)}}if(S.length){S.val("").keyup();N.hide();S.keyup(function(){var t=e(this).val();T.each(function(){if(!e(this).html().match(new RegExp(".*?"+t+".*?","i"))){e(this).hide()}else{e(this).show()}});if(c.first().text()===""&&s.data("placeholder")!==""){T.first().hide()}if(T.filter(":visible").length<1){N.show()}else{N.hide()}})}if(T.filter(".selected").length){if(s.val()===""){k.scrollTop(0)}else{if(k.innerHeight()/i%2!==0){i=i/2}k.scrollTop(k.scrollTop()+T.filter(".selected").position().top-k.innerHeight()/2+i)}}r(k)});T.hover(function(){e(this).siblings().removeClass("selected")});var W=T.filter(".selected").text();T.filter(":not(.disabled):not(.optgroup)").click(function(){var t=e(this),i=t.text();s.focus();if(!t.is(".selected")){var a=t.index();a-=t.prevAll(".optgroup").length;t.addClass("selected sel").siblings().removeClass("selected sel");c.prop("selected",false).eq(a).prop("selected",true);W=i;y.text(i);if(w.data("jqfs-class")){w.removeClass(w.data("jqfs-class"))}w.data("jqfs-class",t.data("jqfs-class"));w.addClass(t.data("jqfs-class"));s.change()}_.hide();w.removeClass("opened dropup dropdown");l.onSelectClosed.call(w)});_.mouseout(function(){e("li.sel",_).addClass("selected")});s.on("change."+t,function(){y.text(c.filter(":selected").text()).removeClass("placeholder");T.removeClass("selected sel").not(".optgroup").eq(s[0].selectedIndex).addClass("selected sel");if(c.first().text()!==T.filter(".selected").text()){w.addClass("changed")}else{w.removeClass("changed")}}).on("focus."+t,function(){w.addClass("focused");e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div.jq-selectbox__dropdown").hide()}).on("blur."+t,function(){w.removeClass("focused")}).on("keydown."+t+" keyup."+t,function(e){var t=T.data("li-height");if(s.val()===""){y.text(h).addClass("placeholder")}else{y.text(c.filter(":selected").text())}T.removeClass("selected sel").not(".optgroup").eq(s[0].selectedIndex).addClass("selected sel");if(e.which===38||e.which===37||e.which===33||e.which===36){if(s.val()===""){k.scrollTop(0)}else{k.scrollTop(k.scrollTop()+T.filter(".selected").position().top)}}if(e.which===40||e.which===39||e.which===34||e.which===35){k.scrollTop(k.scrollTop()+T.filter(".selected").position().top-k.innerHeight()+t)}if(e.which===13){e.preventDefault();_.hide();w.removeClass("opened dropup dropdown");l.onSelectClosed.call(w)}}).on("keydown."+t,function(e){if(e.which===32){e.preventDefault();x.click()}});if(!a.registered){e(document).on("click",a);a.registered=true}}function h(){var i=new d,l=e('<div class="jq-select-multiple jqselect"></div>').css({display:"inline-block",position:"relative"}).attr({id:i.id,title:i.title}).addClass(i.classes).data(i.data);s.css({margin:0,padding:0}).after(l);var a=f();l.append("<ul>"+a+"</ul>");var o=e("ul",l).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),n=e("li",l).attr("unselectable","on"),u=s.attr("size"),h=o.outerHeight(),p=n.outerHeight();if(u!==undefined&&u>0){o.css({height:p*u})}else{o.css({height:p*4})}if(h>l.height()){o.css("overflowY","scroll");r(o);if(n.filter(".selected").length){o.scrollTop(o.scrollTop()+n.filter(".selected").position().top)}}s.prependTo(l).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});if(s.is(":disabled")){l.addClass("disabled");c.each(function(){if(e(this).is(":selected")){n.eq(e(this).index()).addClass("selected")}})}else{n.filter(":not(.disabled):not(.optgroup)").click(function(t){s.focus();var i=e(this);if(!t.ctrlKey&&!t.metaKey){i.addClass("selected")}if(!t.shiftKey){i.addClass("first")}if(!t.ctrlKey&&!t.metaKey&&!t.shiftKey){i.siblings().removeClass("selected first")}if(t.ctrlKey||t.metaKey){if(i.is(".selected")){i.removeClass("selected first")}else{i.addClass("selected first")}i.siblings().removeClass("first")}if(t.shiftKey){var l=false,a=false;i.siblings().removeClass("selected").siblings(".first").addClass("selected");i.prevAll().each(function(){if(e(this).is(".first")){l=true}});i.nextAll().each(function(){if(e(this).is(".first")){a=true}});if(l){i.prevAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(a){i.nextAll().each(function(){if(e(this).is(".selected")){return false}else{e(this).not(".disabled, .optgroup").addClass("selected")}})}if(n.filter(".selected").length===1){i.addClass("first")}}c.prop("selected",false);n.filter(".selected").each(function(){var t=e(this),i=t.index();if(t.is(".option")){i-=t.prevAll(".optgroup").length}c.eq(i).prop("selected",true)});s.change()});c.each(function(t){e(this).data("optionIndex",t)});s.on("change."+t,function(){n.removeClass("selected");var t=[];c.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))});n.not(".optgroup").filter(function(i){return e.inArray(i,t)>-1}).addClass("selected")}).on("focus."+t,function(){l.addClass("focused")}).on("blur."+t,function(){l.removeClass("focused")});if(h>l.height()){s.on("keydown."+t,function(e){if(e.which===38||e.which===37||e.which===33){o.scrollTop(o.scrollTop()+n.filter(".selected").position().top-p)}if(e.which===40||e.which===39||e.which===34){o.scrollTop(o.scrollTop()+n.filter(".selected:last").position().top-o.innerHeight()+p*2)}})}}}if(s.is("[multiple]")){if(n||o){return}h()}else{u()}};h();s.on("refresh",function(){s.off("."+t).parent().before(s).remove();h()})}else if(s.is('input[type="hidden"]')){return false}else if(s.is("input")){s.addClass(t)}else if(s.is(":reset")){s.on("click",function(){setTimeout(function(){s.closest(l.wrapper).find("input, select").trigger("refresh")},1)})}},destroy:function(i){var s=e(this.element);if(!i){s.removeData("_"+t)}if(s.is(":checkbox")||s.is(":radio")){s.off("."+t+" refresh").removeAttr("style").parent().before(s).remove();s.closest("label").add('label[for="'+s.attr("id")+'"]').off("."+t)}else if(s.is('input[type="number"]')){s.off("."+t+" refresh").closest(".jq-number").before(s).remove()}else if(s.is(":file")||s.is("select")){s.off("."+t+" refresh").removeAttr("style").parent().before(s).remove()}},reinitialize:function(t){this.destroy(true);this.options=e.extend({},s,t);this.init()}};e.fn[t]=function(i){var s=arguments;if(i===undefined||typeof i==="object"){this.each(function(){if(!e.data(this,"_"+t)){e.data(this,"_"+t,new l(this,i))}}).promise().done(function(){var i=e(this[0]).data("_"+t);if(i){i.options.onFormStyled.call()}});return this}else if(typeof i==="string"&&i[0]!=="_"&&i!=="init"){var a;this.each(function(){var o=e.data(this,"_"+t);if(o instanceof l&&typeof o[i]==="function"){a=o[i].apply(o,Array.prototype.slice.call(s,1))}});return a!==undefined?a:this}};e.fn.commonParents=function(){var t=this;return t.first().parents().filter(function(){return e(this).find(t).length===t.length})};e.fn.commonParent=function(){return e(this).commonParents().first()};function a(i){if(!e(i.target).parents().hasClass("jq-selectbox")&&i.target.nodeName!=="OPTION"){if(e("div.jq-selectbox.opened").length){var s=e("div.jq-selectbox.opened"),l=e("div.jq-selectbox__search input",s),a=e("div.jq-selectbox__dropdown",s),o=s.find("select").data("_"+t).options;o.onSelectClosed.call(s);if(l.length){l.val("").keyup()}a.hide().find("li.sel").addClass("selected");s.removeClass("focused opened dropup dropdown")}}}a.registered=false});